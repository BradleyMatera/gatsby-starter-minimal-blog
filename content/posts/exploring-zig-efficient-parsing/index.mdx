---
title: "Zig Parsing Lab: Build a Small OBJ Parser"
date: "2025-03-10"
slug: "/exploring-zig-efficient-parsing"
tags: ["zig", "parsing", "performance"]
description: "A complete lab tutorial for parsing OBJ files in Zig with clear steps and checks."
theme: "Systems"
---

Parsing gets clearer when you build something tiny.

This post is a full lab tutorial for a small OBJ parser in Zig.

You will parse one file type, log errors, and verify the output.

If you are new to Zig, this is a good start.

## What this is

High level, you read a text file and translate lines into structured data.

Low level, you parse line prefixes like `v` and store numbers in arrays.

Key terms:

- **OBJ**: a simple 3D model file format.
- **Token**: a piece of a line, such as a float or an index.
- **Parser**: code that turns text into data.

## What you need

- Zig 0.13.x installed.
- A small OBJ file.
- A terminal.

Docs used:

- https://ziglang.org/documentation/0.13.0/
- https://en.wikipedia.org/wiki/Wavefront_.obj_file

## Start to finish

1) Create a Zig project.

Why: You need a clean place to test parsing.

```bash
mkdir zig-obj && cd zig-obj
zig init
```

2) Load the file line by line.

Why: OBJ is line-based.

```zig
const line = try reader.readUntilDelimiterOrEofAlloc(allocator, '\n', 2048);
```

3) Match line prefixes.

Why: `v` lines are vertices, `f` lines are faces.

```zig
if (std.mem.startsWith(u8, line, "v ")) {
    // parse vertex
}
```

4) Parse numbers.

Why: You need floats and indices in numeric form.

Use `std.fmt.parseFloat` for floats.

5) Store parsed values.

Why: You need a data structure to verify later.

## Verify it worked

- Print the number of vertices and faces.
- Compare with the input file.

Example output:

```text
vertices: 8
faces: 12
```

If the numbers are wrong, log the line that failed.

## Common mistakes

- **Symptom**: Parser crashes on a line.
  **Cause**: Line length too small.
  **Fix**: Increase the buffer size.

- **Symptom**: Wrong counts.
  **Cause**: Ignoring blank or comment lines.
  **Fix**: Skip lines that start with `#`.

- **Symptom**: Float parse errors.
  **Cause**: Extra spaces.
  **Fix**: Split by whitespace and trim.

## Cheat sheet

- Read line by line.
- Check line prefixes.
- Parse tokens into numbers.
- Log failures.

## Next steps

- Add face parsing.
- Add a simple benchmark.
- Add unit tests for bad input.

Related links:

- https://ziglang.org/documentation/0.13.0/
- https://en.wikipedia.org/wiki/Wavefront_.obj_file

Final CTA:

If you want the sample OBJ files I used, ask and I will share them.
