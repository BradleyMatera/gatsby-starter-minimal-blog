---
title: "JWT CTF Lab: Debugging Auth Tokens Step by Step"
date: "2025-10-08"
slug: "/jwt-ctf-lab"
tags: ["security", "ctf", "jwt", "debugging"]
description: "A plainspoken lab write-up that shows how I debug JWT issues without claiming production experience."
theme: "Security"
---

I broke a JWT lab in five different ways before I solved it.

This post shows the exact steps I used to find the bug and fix it. It is all lab work. No production systems.

You will get a clear checklist, a small decoding snippet, and the mistakes I made so you can avoid them.

## The promise

By the end, you will be able to:

- decode a JWT safely
- validate claims with simple checks
- document your steps so you can reproduce the fix

> "If I cannot explain the token in plain English, I do not trust it."

## What I was working on

This was a CTF lab. The goal was to identify a broken token flow and fix it. The lab is safe and isolated.

I used my own notes and debug logs. I did not touch real user data.

### Tools I used

- A text editor
- A local terminal
- A JWT decode helper

## The core idea

JWT issues usually fall into a short list:

- the header is wrong
- the payload claims are wrong
- the signature is missing or mismatched

I treat it like a small checklist. That keeps me calm and consistent.

### Example decode snippet

This is a quick decode helper I use in labs:

```js
// Example only. Do not use this to verify signatures.
function decodeJwt(token) {
  const [, payload] = token.split(".");
  const json = Buffer.from(payload, "base64").toString("utf8");
  return JSON.parse(json);
}
```

## How I debugged the lab

1. Extract the token from the request.
2. Decode the payload and read the claims.
3. Compare claims against the lab rules.
4. Check time fields with the current clock.
5. Update the token and retry.

### Common mistakes

- Trusting a decode as proof of validity.
- Ignoring clock skew and expiry.
- Skipping the audience and issuer checks.

### Quick checklist

- [ ] Header uses the expected algorithm
- [ ] Payload has iss, aud, sub
- [ ] iat and exp look sane
- [ ] Token format is header.payload.signature

## CTA: Open the lab notes

If you want the exact steps, open the notes in this repo:

- https://github.com/BradleyMatera/learning-journal

## Now do it your way

Try the same checklist on a different lab. Write down each step. Do not rely on memory.

### Pitfalls to watch

- Mixing token formats from different exercises
- Copying tokens without checking the timestamp
- Skipping the lab rules

## Next steps

- Write your own debug checklist in plain English.
- Re-run the lab and compare results.
- Add a short summary to your notes.

## Related links

- https://jwt.io/introduction
- https://owasp.org/www-project-cheat-sheets/cheatsheets/JSON_Web_Token_Cheat_Sheet_for_Java.html
- https://github.com/BradleyMatera/learning-journal

## Final CTA

If you run this lab, send me your checklist. I will compare notes.
