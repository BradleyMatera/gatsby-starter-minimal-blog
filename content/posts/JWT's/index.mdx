---
title: "JWT CTF Lab: A Full Debug Walkthrough"
date: "2025-10-08"
slug: "/jwt-ctf-lab"
tags: ["security", "ctf", "jwt", "debugging"]
description: "A complete lab tutorial for decoding, checking, and fixing JWTs without claiming production experience."
theme: "Security"
---

JWT bugs are common because people skip basic checks.

This post is a full lab walkthrough, not a production story.

You will decode a token, validate claims, and fix a broken flow.

If you are new to JWTs, this is for you.

## What this is

High level, a JWT is a signed string used to pass claims between a client and server.

Low level, it is three base64url parts: header, payload, signature.

Key terms:

- **Header**: metadata like the algorithm used to sign the token.
- **Payload**: the claims, such as subject, issuer, and expiry.
- **Signature**: the cryptographic proof the token was not tampered with.

## What you need

- A JWT string from your lab.
- Node.js 18 or later.
- A text editor and a terminal.

Optional but helpful:

- A JWT debugger like https://jwt.io

## Start to finish

1) Copy the token from the lab.

Why: You need the raw string for every check.

2) Split the token into its three parts.

Why: You need to inspect header and payload separately.

```bash
node -e "const t=process.argv[1]; console.log(t.split('.'))" "YOUR.JWT.HERE"
```

3) Decode the payload.

Why: You need to read claims like exp and aud.

```bash
node -e "const p=process.argv[1].split('.')[1]; console.log(Buffer.from(p,'base64url').toString('utf8'))" "YOUR.JWT.HERE"
```

4) Check core claims.

Why: Most lab failures are missing or wrong claims.

Check at least:

- iss (issuer)
- aud (audience)
- sub (subject)
- exp (expiry)

5) Fix the claim or regenerate the token.

Why: A corrected claim is only valid if it matches the lab rules.

If you are using a lab tool, follow its exact signing steps.

6) Retry the lab request.

Why: You need to confirm the fix, not just the theory.

## Verify it worked

- The lab should accept the token.
- The server should stop returning auth errors.

If you see **401 Unauthorized**, it usually means a missing or invalid claim.

If you see **403 Forbidden**, it often means the claim is valid but not allowed.

## Common mistakes

- **Symptom**: Token decodes but still fails.
  **Cause**: You only decoded, you did not verify claims.
  **Fix**: Check iss, aud, sub, exp one by one.

- **Symptom**: Expired token.
  **Cause**: Wrong system time or wrong exp value.
  **Fix**: Regenerate with a fresh exp.

- **Symptom**: Algorithm mismatch.
  **Cause**: Header alg does not match the lab rules.
  **Fix**: Use the correct signing algorithm.

## Cheat sheet

- JWT is header.payload.signature.
- Decode does not equal verify.
- Check iss, aud, sub, exp every time.
- Fix one claim at a time.
- Re-run the lab after each change.

## Next steps

- Try the same checklist on a new lab token.
- Write a short debug note after each fix.
- Read the OWASP JWT cheat sheet.

Related links:

- https://jwt.io/introduction
- https://owasp.org/www-project-cheat-sheets/cheatsheets/JSON_Web_Token_Cheat_Sheet_for_Java.html

Final CTA:

If you want a short JWT checklist you can print, ask and I will share it.
